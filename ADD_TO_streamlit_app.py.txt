# --- Optional runtime guard: install Chromium if missing ---
def _ensure_playwright_browser():
    try:
        from playwright._impl._driver import compute_driver_executable
        import subprocess, sys
        # If driver isn't there, this will raise; fall back to install
        _ = compute_driver_executable()
    except Exception:
        try:
            # Try a lightweight install without system deps (those should be in the image)
            subprocess.run([sys.executable, "-m", "playwright", "install", "chromium"], check=True)
        except Exception:
            pass  # Last resort: rely on postBuild
# Call early in app startup
try:
    _ensure_playwright_browser()
except Exception:
    pass
# --- End runtime guard ---
